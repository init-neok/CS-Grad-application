{% extends "base.html" %}
{% block title %}Explore Â· CS Grad Insight{% endblock %}
{% block content %}
<div class="d-flex flex-wrap justify-content-between align-items-center mb-4 gap-3">
  <div>
    <h1 class="h3">Explore Application Outcomes</h1>
    <p class="text-muted mb-0">Filter by school, program, term, or result to see anonymized entries.</p>
  </div>
  <div class="text-end">
    <div class="fw-semibold">Total records: {{ stats.total_applications }}</div>
    <small class="text-muted">Updated live from the database.</small>
  </div>
</div>

<form id="search-form" class="card shadow-sm p-3 mb-4">
  <div class="row g-3">
    <div class="col-md-3">
      <label class="form-label">University</label>
      <input class="form-control" name="university" placeholder="e.g. Stanford" />
    </div>
    <div class="col-md-3">
      <label class="form-label">Program</label>
      <input class="form-control" name="program" placeholder="e.g. MS CS" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Country</label>
      <input class="form-control" name="country" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Degree</label>
      <select class="form-select" name="degree">
        <option value="">Any</option>
        <option>MS</option>
        <option>PhD</option>
        <option>MEng</option>
      </select>
    </div>
    <div class="col-md-2">
      <label class="form-label">Result</label>
      <select class="form-select" name="result">
        <option value="">Any</option>
        <option>Admit</option>
        <option>Reject</option>
        <option>Waitlist</option>
      </select>
    </div>
  </div>
  <div class="row g-3 mt-2 align-items-end">
    <div class="col-md-2">
      <label class="form-label">Term</label>
      <input class="form-control" name="term" placeholder="Fall 2024" />
    </div>
    <div class="col-md-2">
      <label class="form-label">Sort</label>
      <select class="form-select" name="sort">
        <option value="recent">Most recent</option>
        <option value="university">University</option>
        <option value="program">Program</option>
      </select>
    </div>
    <div class="col-md-2">
      <label class="form-label">Limit</label>
      <input class="form-control" type="number" name="limit" value="50" min="1" max="200" />
    </div>
    <div class="col-md-6 text-md-end">
      <button class="btn btn-primary" type="submit">Search</button>
      <button class="btn btn-outline-secondary" type="reset" id="reset-search">Reset</button>
    </div>
  </div>
</form>

<div class="card shadow-sm">
  <div class="card-body">
    <div class="d-flex justify-content-between align-items-center mb-2 flex-wrap gap-2">
      <div>
        <div class="fw-semibold">Results</div>
        <small class="text-muted" id="results-count">Showing up to 0 entries.</small>
      </div>
      <a class="btn btn-sm btn-outline-primary" href="/api/search/applications" target="_blank">
        Raw API
      </a>
    </div>
    <div class="table-responsive" style="max-height: 500px">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>University</th>
            <th>Program</th>
            <th>Degree</th>
            <th>Term</th>
            <th>Result</th>
            <th>GPA</th>
            <th>GRE</th>
          </tr>
        </thead>
        <tbody id="results-body"></tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
{% block scripts %}
<script src="{{ url_for('static', filename='js/explore.js') }}" defer></script>
{% endblock %}
